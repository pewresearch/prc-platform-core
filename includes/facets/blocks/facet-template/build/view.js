import*as e from"@wordpress/interactivity";var t={d:(e,c)=>{for(var o in c)t.o(c,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:c[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const c=(o={getContext:()=>e.getContext,getElement:()=>e.getElement,getServerContext:()=>e.getServerContext,getServerState:()=>e.getServerState,store:()=>e.store},n={},t.d(n,o),n);var o,n;const{state:r,actions:l}=(0,c.store)("prc-platform/facets-context-provider",{state:{get label(){const e=(0,c.getContext)().choice,{facetSlug:t,label:o,value:n}=e;return`${o} (${function(e,t,c){const o=c.find((e=>e.value===t));return o?o.count:null}(0,n,(0,c.getServerState)().facets[t].choices)})`},get isSelected(){const{facetSlug:e,value:t}=(0,c.getContext)().choice;return r.selected[e].includes(t)},get checked(){const{facetSlug:e,value:t}=(0,c.getContext)().choice;return r.selected[e].includes(t)},get id(){const e=(0,c.getContext)();return`facet_${e.choice.slug}_${e.choice.term_id}`},get type(){return(0,c.getContext)().choice.type},get value(){return(0,c.getContext)().choice.value},get slug(){return(0,c.getContext)().choice.slug},get name(){return(0,c.getContext)().choice.slug},get facetSlug(){return(0,c.getContext)().choice.facetSlug},get hasExpandedChoices(){return(0,c.getServerContext)().expandedChoices&&(0,c.getServerContext)().expandedChoices.length>0},get placeholder(){const e=(0,c.getContext)(),{facetSlug:t,placeholder:o}=e,{selected:n}=r,l=n[t];let a=`Select ${o}`;return void 0!==l&&1<=l.length&&(a=l.map((e=>e.replace(/-/g," ").split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "))).join(", ")),a},get facetChoices(){return(0,c.getServerContext)().choices},get facetExpandedChoices(){return(0,c.getServerContext)().expandedChoices},get filterableFacetChoices(){const{searchValue:e}=(0,c.getContext)(),{data:t}=(0,c.getServerContext)();return e?t.filter((t=>{const{label:c}=t;return c.toLowerCase().includes(e.toLowerCase())})):t},get hasSelections(){const{facetSlug:e}=(0,c.getContext)(),{selected:t}=r;return t[e].length>0}},actions:{clearFacet:()=>{const{facetSlug:e}=(0,c.getContext)();l.onClear(e)},onCheckboxClick:()=>{const{value:e,facetSlug:t,getSelected:c}=r;c[t]&&0!==c[t].length?c[t].includes(e)?r.selected[t]=c[t].filter((t=>t!==e)):"radio"===r.type?r.selected[t]=[e]:r.selected[t]=[...c[t],e]:r.selected[t]=[e]},*onCheckboxMouseEnter(){const{facetSlug:e,value:t,getSelected:c}=r,o={...c[e]||[],[e]:t},n=l.constructNewUrl(o);yield l.prefetch(n)},onSelectClick:()=>{const e=(0,c.getContext)(),{facetSlug:t,value:o}=e.choice,n=r.getSelected,l=n;n[t]&&n[t].includes(o)?l[t]=l[t].filter((e=>e!==o)):l[t]=[o],r.selected=l,e.searchValue=""},onExpand:()=>{const e=(0,c.getContext)();e.expanded=!e.expanded},onCollapse:()=>{const e=(0,c.getContext)();let t=!1;t||(t=!0,setTimeout((()=>{e.expanded=!1,t=!1}),150))},moveThroughChoices:(e,t)=>{const{facetChoices:o}=r,{activeIndex:n}=(0,c.getContext)();let l=null;l=null===n||isNaN(n)?0:n+e,l<0&&(l=o.length-1),l>=o.length&&(l=0);const a=o[l].value,s=t.parentElement.parentElement.querySelector(".wp-block-prc-platform-facet-select-field__list"),g=s.querySelector(`[data-ref-value="${a}"]`);if(g){const e=s.querySelector(".is-selected");e&&e.classList.remove("is-selected"),g.classList.add("is-selected"),g.scrollIntoView({block:"nearest"})}(0,c.getContext)().activeIndex=l},onSelectKeyUp:e=>{e.preventDefault();const t=(0,c.getContext)(),{facetSlug:o,activeIndex:n,choices:a}=t,{value:s}=e.target,{ref:g}=(0,c.getElement)();if("Escape"!==e.key)if(40!==e.keyCode||"ArrowDown"!==e.key)if(38!==e.keyCode||"ArrowUp"!==e.key){if("Enter"===e.key){const e=a[n].value,c=r.selected,l=c;return c[o]&&c[o].includes(e)?l[o]=l[o].filter((t=>t!==e)):l[o]=[e],t.expanded=!1,void(r.selected=l)}(0,c.getContext)().searchValue=s.toLowerCase()}else l.moveThroughChoices(-1,e.target);else l.moveThroughChoices(1,e.target);else!0===(0,c.getContext)().expanded&&g.blur()}},callbacks:{onUpdates:()=>{(0,c.getContext)(),(0,c.getServerContext)()},onExpand:()=>{const e=(0,c.getContext)(),{expanded:t}=e;e.expandedLabel=t?"- Less":"+ More"}}});
//# sourceMappingURL=view.js.map