(()=>{"use strict";var e={n:i=>{var o=i&&i.__esModule?()=>i.default:()=>i;return e.d(o,{a:o}),o},d:(i,o)=>{for(var n in o)e.o(o,n)&&!e.o(i,n)&&Object.defineProperty(i,n,{enumerable:!0,get:o[n]})},o:(e,i)=>Object.prototype.hasOwnProperty.call(e,i)};const i=window.lodash;var o=e.n(i);const n=window.wp.i18n,t=window.wp.plugins,r=window.React,a=window.wp.data,s=window.wp.editPost,d=window.wp.components,l=window.wp.mediaUtils,c=window.ReactJSXRuntime,{prcFlashBriefingConfig:w}=window,p=w.apiToken,u=({blockContent:e})=>(0,c.jsxs)(d.PanelBody,{title:(0,n.__)("Alexa Preview","alexa-preview"),children:[(0,c.jsx)(d.PanelRow,{children:(0,n.__)('A preview of the audio generated for the Amazon Alexa "Flash Briefing" skill.',"alexa-preview")}),(0,c.jsx)(d.PanelRow,{children:(0,c.jsxs)("audio",{id:"audio-el",controls:!0,children:[(0,c.jsx)("source",{id:"audio-source",src:"",type:"audio/mpeg"}),"Your browser does not support the audio element."]})}),(0,c.jsx)(d.PanelRow,{children:(0,c.jsx)(d.Button,{onClick:()=>{const i=wp.data.select("core/editor").getCurrentPostId();(async function(e,i){const o=await fetch("https://polly.pewresearch.io/speak?voice=Joanna",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)});return console.log({res:o}),await o.blob()})(0,{TEXT:`${e} For more, visit pew research dot org.`,SECURITY_TOKEN:p}).then((e=>{((e,i)=>{(new wp.api.collections.Media).fetch({data:{parent:i}}).then((o=>{o.length>0&&o.forEach((e=>{const i=new wp.api.models.Media({id:e.id});i.fetch(),i.destroy()})),(0,l.uploadMedia)({filesList:[new File([e],`brief-${i}-${Date.now()}.mp3`,{type:"audio/mpeg"})],additionalData:{post:i},onFileChange:([e])=>{e&&e?.url&&(document.getElementById("audio-source").src=e.url,document.getElementById("audio-el").load())},onError:console.error})}))})(e,i)}))},className:"components-button is-button is-default is-large",children:(0,n.__)("Retrieve preview audio","alexa-preview")})})]});(0,t.registerPlugin)("flash-briefing-preview",{icon:"media-audio",render:function(){const e=(0,a.useSelect)((e=>e("core/editor").getBlocks())).map((e=>o().unescape(e.attributes.content))).join(" ");return(0,c.jsxs)(r.Fragment,{children:[(0,c.jsx)(s.PluginSidebarMoreMenuItem,{target:"flash-briefing-preview-audio",children:(0,n.__)("Flash Briefing Preview Audio Suck Butt","flash-briefing-preview-audio")}),(0,c.jsx)(s.PluginSidebar,{name:"flash-briefing-preview-audio",title:(0,n.__)("Flash Briefing Preview Audio Suck .. not","flash-briefing"),children:(0,c.jsx)(u,{blockContent:e})})]})}})})();
//# sourceMappingURL=index.js.map