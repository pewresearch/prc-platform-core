{"version":3,"file":"index.js","mappings":"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","sources":["webpack://@pewresearch/prc-platform-homepages/external window \"React\"","webpack://@pewresearch/prc-platform-homepages/external window [\"wp\",\"primitives\"]","webpack://@pewresearch/prc-platform-homepages/./node_modules/@wordpress/icons/build-module/library/home.js","webpack://@pewresearch/prc-platform-homepages/external window [\"wp\",\"blocks\"]","webpack://@pewresearch/prc-platform-homepages/external window \"prcComponents\"","webpack://@pewresearch/prc-platform-homepages/external window [\"wp\",\"coreData\"]","webpack://@pewresearch/prc-platform-homepages/external window [\"wp\",\"blockEditor\"]","webpack://@pewresearch/prc-platform-homepages/external window [\"wp\",\"components\"]","webpack://@pewresearch/prc-platform-homepages/external window [\"wp\",\"data\"]","webpack://@pewresearch/prc-platform-homepages/./src/constants.js","webpack://@pewresearch/prc-platform-homepages/./src/create-new-homepage-modal.jsx","webpack://@pewresearch/prc-platform-homepages/./src/create-homepage.js","webpack://@pewresearch/prc-platform-homepages/external window [\"wp\",\"i18n\"]","webpack://@pewresearch/prc-platform-homepages/./src/preview-selection-modal.jsx","webpack://@pewresearch/prc-platform-homepages/./src/controls.jsx","webpack://@pewresearch/prc-platform-homepages/./src/index.js","webpack://@pewresearch/prc-platform-homepages/./src/edit.jsx"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = window[\"React\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"primitives\"];","import { createElement } from \"react\";\n/**\n * WordPress dependencies\n */\nimport { SVG, Path } from '@wordpress/primitives';\nconst home = createElement(SVG, {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  viewBox: \"0 0 24 24\"\n}, createElement(Path, {\n  d: \"M12 4L4 7.9V20h16V7.9L12 4zm6.5 14.5H14V13h-4v5.5H5.5V8.8L12 5.7l6.5 3.1v9.7z\"\n}));\nexport default home;\n//# sourceMappingURL=home.js.map","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"blocks\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"prcComponents\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"coreData\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"blockEditor\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"components\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"data\"];","const POST_TYPE = 'homepage';\nconst POST_TYPE_LABEL = 'Homepage';\nconst DEFAULT_CONTENT = `\n<!-- wp:group {\"layout\":{\"type\":\"constrained\",\"contentSize\":\"1200px\"}} -->\n<div class=\"wp-block-group\"><!-- wp:prc-block/grid-controller {\"dividerColor\":\"gray\",\"className\":\"is-pattern__featured-layout\"} -->\n<!-- wp:prc-block/grid-column {\"gridLayout\":{\"index\":1,\"desktopSpan\":\"3\",\"tabletSpan\":\"6\",\"mobileSpan\":\"4\"}} -->\n<!-- wp:prc-block/story-item {\"imageSize\":\"A2\",\"postId\":0,\"metaTaxonomy\":\"category\"} /-->\n\n<!-- wp:prc-block/story-item {\"imageSize\":\"A2\",\"postId\":0,\"metaTaxonomy\":\"category\"} /-->\n<!-- /wp:prc-block/grid-column -->\n\n<!-- wp:prc-block/grid-column {\"gridLayout\":{\"index\":2,\"desktopSpan\":\"6\",\"tabletSpan\":\"12\",\"mobileSpan\":\"4\"}} -->\n<!-- wp:prc-block/story-item {\"postId\":0,\"metaTaxonomy\":\"category\"} /-->\n<!-- /wp:prc-block/grid-column -->\n\n<!-- wp:prc-block/grid-column {\"gridLayout\":{\"index\":3,\"desktopSpan\":\"3\",\"tabletSpan\":\"6\",\"mobileSpan\":\"4\"}} -->\n<!-- wp:prc-block/story-item {\"imageSize\":\"A2\",\"postId\":0,\"metaTaxonomy\":\"category\"} /-->\n\n<!-- wp:prc-block/story-item {\"imageSize\":\"A2\",\"postId\":0,\"metaTaxonomy\":\"category\"} /-->\n<!-- /wp:prc-block/grid-column -->\n<!-- /wp:prc-block/grid-controller --></div>\n<!-- /wp:group -->\n`;\n\nexport { POST_TYPE, POST_TYPE_LABEL, DEFAULT_CONTENT };\n","/**\n * External Dependencies\n */\nimport { EntityCreateNewModal } from '@prc/components';\n\n/**\n * WordPress Dependencies\n */\nimport { useState, Fragment } from 'react';\nimport { Button } from '@wordpress/components';\n\n/**\n * Internal Dependencies\n */\nimport createHomepage from './create-homepage';\nimport { DEFAULT_CONTENT } from './constants';\n\n// get today's date in MM/DD/YYYY format\nconst today = new Date().toLocaleDateString('en-US', {\n\tmonth: '2-digit',\n\tday: '2-digit',\n\tyear: '2-digit',\n});\n\nexport default function CreateNewHomepageModal({\n\tpreviewedHomepageId,\n\tsetPreviewedHomepageId,\n\tclientId,\n}) {\n\tconst [active, setActive] = useState(false);\n\tconst toggleActive = () => setActive(!active);\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<Button variant=\"secondary\" onClick={toggleActive}>\n\t\t\t\tCreate New Draft\n\t\t\t</Button>\n\t\t\t{active && (\n\t\t\t\t<EntityCreateNewModal\n\t\t\t\t\t{...{\n\t\t\t\t\t\tentityType: 'homepage',\n\t\t\t\t\t\tdefaultTitle: `Homepage ${today}`,\n\t\t\t\t\t\tdefaultContent: DEFAULT_CONTENT,\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\ttoggleActive();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonSubmit: (newTitle, defaultContent) => {\n\t\t\t\t\t\t\tcreateHomepage(\n\t\t\t\t\t\t\t\tnewTitle,\n\t\t\t\t\t\t\t\tdefaultContent,\n\t\t\t\t\t\t\t\t'draft'\n\t\t\t\t\t\t\t).then((response) => {\n\t\t\t\t\t\t\t\tconsole.log('then...', response);\n\t\t\t\t\t\t\t\tsetPreviewedHomepageId(response.id);\n\t\t\t\t\t\t\t\ttoggleActive();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t)}\n\t\t</Fragment>\n\t);\n}\n","/**\n * WordPress Dependencies\n */\nimport { store as coreStore } from '@wordpress/core-data';\nimport { dispatch } from '@wordpress/data';\n\n/**\n * Internal Dependencies\n */\nimport { POST_TYPE } from './constants';\n\nexport default async function createHomepage(\n\thomepageTitle,\n\tdefaultContent,\n\tstatus = 'draft'\n) {\n\tconst args = {\n\t\ttitle: homepageTitle,\n\t\tcontent: defaultContent,\n\t\tstatus,\n\t};\n\n\tconst { saveEntityRecord } = dispatch(coreStore);\n\n\tconst newHomepage = await saveEntityRecord('postType', POST_TYPE, args);\n\n\tif (newHomepage) {\n\t\tconsole.log('onCreateHomepage', newHomepage);\n\t\treturn newHomepage;\n\t}\n\n\treturn false;\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"i18n\"];","/**\n * External Dependencies\n */\nimport { EntityPatternModal } from '@prc/components';\n\n/**\n * WordPress Dependencies\n */\nimport { useState, Fragment } from 'react';\nimport { __ } from '@wordpress/i18n';\nimport { Button } from '@wordpress/components';\n\nexport default function PreviewSelectionModal({\n\tpreviewedHomepageId,\n\tsetPreviewedHomepageId,\n\tclientId,\n}) {\n\tconst [active, setActive] = useState(false);\n\tconst toggleActive = () => setActive(!active);\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<Button variant=\"secondary\" onClick={toggleActive}>\n\t\t\t\tPreview Different Homepage\n\t\t\t</Button>\n\t\t\t{active && (\n\t\t\t\t<EntityPatternModal\n\t\t\t\t\t{...{\n\t\t\t\t\t\ttitle: __(\n\t\t\t\t\t\t\t'Preview an existing homepage',\n\t\t\t\t\t\t\t'prc-platform-homepages'\n\t\t\t\t\t\t),\n\t\t\t\t\t\tinstructions: __(\n\t\t\t\t\t\t\t'Select a homepage to preview',\n\t\t\t\t\t\t\t'prc-platform-homepages'\n\t\t\t\t\t\t),\n\t\t\t\t\t\tentityType: 'homepage',\n\t\t\t\t\t\tentityTypeLabel: __(\n\t\t\t\t\t\t\t'Homepage',\n\t\t\t\t\t\t\t'prc-platform-homepages'\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonSelect: (homepage) => {\n\t\t\t\t\t\t\tconsole.log(\"On select\", homepage);\n\t\t\t\t\t\t\tsetPreviewedHomepageId(homepage?.id);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\ttoggleActive();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstatus: 'draft',\n\t\t\t\t\t\tselectedId: previewedHomepageId,\n\t\t\t\t\t\tclientId,\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t)}\n\t\t</Fragment>\n\t);\n}\n","/**\n * WordPress Dependencies\n */\nimport { InspectorControls } from '@wordpress/block-editor';\nimport { PanelBody, PanelRow } from '@wordpress/components';\n\n/**\n * Internal Dependencies\n */\nimport CreateNewHomepageModal from './create-new-homepage-modal';\nimport PreviewSelectionModal from './preview-selection-modal';\n\nexport default function Controls({\n\tpreviewedHomepageId,\n\tsetPreviewedHomepageId,\n\tclientId,\n}) {\n\treturn (\n\t\t<InspectorControls>\n\t\t\t<PanelBody title=\"Homepage Options\">\n\t\t\t\t<PanelRow>\n\t\t\t\t\t<PreviewSelectionModal\n\t\t\t\t\t\t{...{\n\t\t\t\t\t\t\tpreviewedHomepageId,\n\t\t\t\t\t\t\tsetPreviewedHomepageId,\n\t\t\t\t\t\t\tclientId,\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</PanelRow>\n\t\t\t\t<PanelRow>\n\t\t\t\t\t<CreateNewHomepageModal\n\t\t\t\t\t\t{...{\n\t\t\t\t\t\t\tpreviewedHomepageId,\n\t\t\t\t\t\t\tsetPreviewedHomepageId,\n\t\t\t\t\t\t\tclientId,\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</PanelRow>\n\t\t\t</PanelBody>\n\t\t</InspectorControls>\n\t);\n}\n","/**\n * Registers a new block provided a unique name and an object defining its behavior.\n *\n * @see https://developer.wordpress.org/block-editor/developers/block-api/#registering-a-block\n */\n\n/**\n * External Dependencies\n */\nimport { home as icon } from '@wordpress/icons';\n\n/**\n * WordPress Dependencies\n */\nimport { registerBlockType } from '@wordpress/blocks';\n\n/**\n * Internal Dependencies\n */\nimport edit from './edit';\nimport metadata from './block.json';\n\nconst { name } = metadata;\n\nconst settings = {\n\ticon,\n\tedit,\n};\n\n/**\n * Every block starts by registering a new block type definition.\n *\n * @see https://developer.wordpress.org/block-editor/developers/block-api/#registering-a-block\n */\nregisterBlockType(name, { ...metadata, ...settings });\n","/* eslint-disable @wordpress/i18n-no-variables */\n/* eslint-disable @wordpress/i18n-no-collapsible-whitespace */\n/* eslint-disable @wordpress/no-unsafe-wp-apis */\n/**\n * External Dependencies\n */\nimport { InnerBlocksAsSyncedContent } from '@prc/components';\n\n/**\n * WordPress Dependencies\n */\nimport { Fragment, useMemo, useState, useEffect } from 'react';\nimport { useEntityRecords } from '@wordpress/core-data';\nimport { useBlockProps } from '@wordpress/block-editor';\n\n/**\n * Internal Dependencies\n */\nimport Controls from './controls';\nimport { POST_TYPE, POST_TYPE_LABEL } from './constants';\n\nexport default function Edit({ clientId, context }) {\n\tconst [previewedHomepageId, setPreviewedHomepageId] = useState();\n\n\tconst queryArgs = {\n\t\tper_page: 1,\n\t\tcontext: 'view',\n\t\torderby: 'date',\n\t\torder: 'desc',\n\t};\n\n\tconst { records, hasResolved } = useEntityRecords(\n\t\t'postType',\n\t\tPOST_TYPE,\n\t\tqueryArgs\n\t);\n\n\t// This sets the previewed homepage ID to the first homepage record fetched from the API and updates it if the latest homepage has changed.\n\tuseEffect(() => {\n\t\tif (records?.length === 0 || !hasResolved) {\n\t\t\treturn;\n\t\t}\n\t\t// If there is no previewed homepage or the previewed homepage is different from the one that was just fetched, update the previewed homepage ID.\n\t\tif (records[0].id && previewedHomepageId !== records[0].id) {\n\t\t\tsetPreviewedHomepageId(records[0].id);\n\t\t}\n\t}, [hasResolved, records, previewedHomepageId]);\n\n\tconst blockProps = useBlockProps();\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<Controls\n\t\t\t\t{...{\n\t\t\t\t\tpreviewedHomepageId,\n\t\t\t\t\tsetPreviewedHomepageId,\n\t\t\t\t\tclientId,\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<InnerBlocksAsSyncedContent\n\t\t\t\t{...{\n\t\t\t\t\tpostId: previewedHomepageId,\n\t\t\t\t\tpostType: POST_TYPE,\n\t\t\t\t\tpostTypeLabel: POST_TYPE_LABEL,\n\t\t\t\t\tblockProps,\n\t\t\t\t\tclientId,\n\t\t\t\t}}\n\t\t\t/>\n\t\t</Fragment>\n\t);\n}\n"],"names":["window","createElement","SVG","xmlns","viewBox","Path","d","POST_TYPE","DEFAULT_CONTENT","today","Date","toLocaleDateString","month","day","year","CreateNewHomepageModal","previewedHomepageId","setPreviewedHomepageId","clientId","active","setActive","useState","toggleActive","Fragment","Button","variant","onClick","EntityCreateNewModal","entityType","defaultTitle","defaultContent","onClose","onSubmit","newTitle","async","homepageTitle","status","args","title","content","saveEntityRecord","dispatch","coreStore","newHomepage","console","log","createHomepage","then","response","id","PreviewSelectionModal","EntityPatternModal","__","instructions","entityTypeLabel","onSelect","homepage","selectedId","Controls","InspectorControls","PanelBody","PanelRow","name","metadata","settings","icon","edit","context","records","hasResolved","useEntityRecords","per_page","orderby","order","useEffect","length","blockProps","useBlockProps","InnerBlocksAsSyncedContent","postId","postType","postTypeLabel","registerBlockType"],"sourceRoot":""}