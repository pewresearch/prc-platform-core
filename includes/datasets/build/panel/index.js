(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.primitives,a=window.ReactJSXRuntime,n=(0,a.jsx)(t.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,a.jsx)(t.Path,{d:"M18 11.3l-1-1.1-4 4V3h-1.5v11.3L7 10.2l-1 1.1 6.2 5.8 5.8-5.8zm.5 3.7v3.5h-13V15H4v5h16v-5h-1.5z"})}),o=window.wp.element,s=(0,o.forwardRef)((function({icon:e,size:t=24,...a},n){return(0,o.cloneElement)(e,{width:t,height:t,...a,ref:n})})),i=window.prcComponents,d=window.wp.i18n,l=window.React,r=window.wp.plugins,p=window.wp.editor,c=window.wp.data,w=window.wp.coreData,h=window.wp.components,u=window.wp.apiFetch;var m=e.n(u);const _="prc-platform-datasets-panel",g=["application/zip","application/pdf"];(0,r.registerPlugin)(_,{render:function(){const{postType:e,postId:t}=(0,c.useSelect)((e=>({postType:e(p.store).getCurrentPostType(),postId:e(p.store).getCurrentPostId()})),[]),[o,r]=(0,w.useEntityProp)("postType",e,"meta",t),{attachmentId:u,isAtp:x,datasetSchema:b}=(0,l.useMemo)((()=>({attachmentId:o._download_attachment_id||!1,isAtp:o.is_atp||!1,datasetSchema:o.dataset_schema||""})),[o]),j=function(e){const[t,a]=(0,l.useState)(null);return(0,l.useEffect)((()=>{m()({path:`/prc-api/v3/datasets/download-stats?dataset_id=${e}`,method:"GET"}).then((e=>{a({success:!0,...e})})).catch((e=>{console.error({error:e})}))}),[e]),t}(t);return(0,a.jsxs)(l.Fragment,{children:[(0,a.jsx)(p.PluginSidebarMoreMenuItem,{target:_,icon:n,children:(0,d.__)("Dataset Options")}),(0,a.jsxs)(p.PluginSidebar,{name:_,title:"Dataset Options",icon:(0,a.jsx)(s,{icon:n,size:16}),children:[(0,a.jsxs)(h.PanelBody,{title:"Dataset File",children:[(0,a.jsx)(i.MediaDropZone,{attachmentId:u,disabled:!1,onUpdate:e=>{r({...o,_download_attachment_id:e.id})},editButtonLabel:(0,d.__)("Edit Dataset File"),onClear:!1,allowedTypes:g,label:(0,d.__)("Upload Dataset File (zip or pdf)"),singularLabel:(0,d.__)("dataset")}),(0,a.jsx)(h.CardDivider,{}),(0,a.jsx)(h.ToggleControl,{label:"ATP Dataset",help:"ATP datasets are bound by an opt-in to the ATP Terms of Service.",checked:x,onChange:e=>{r({...o,is_atp:e})}})]}),(0,a.jsx)(h.PanelBody,{title:"Dataset Schema",children:(0,a.jsx)(h.TextareaControl,{label:"Dataset Schema",value:b,onChange:e=>{r({...o,dataset_schema:e})}})}),j?.success&&(0,a.jsxs)(h.PanelBody,{title:"Dataset Download Stats",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Total Downloads:"})," ",j?.total]}),(0,a.jsx)(h.TextareaControl,{disabled:!0,label:"Monthly Download Stats",value:JSON.stringify(j?.log,null,2)})]})]}),(0,a.jsx)(p.PluginPrePublishPanel,{children:(0,a.jsxs)(h.PanelBody,{title:"Review Dataset Options",children:[(0,a.jsx)(i.MediaDropZone,{attachmentId:u,disabled:!1,onUpdate:e=>{r({...o,_download_attachment_id:e.id})},editButtonLabel:(0,d.__)("Edit Dataset File"),onClear:!1,allowedTypes:g,label:(0,d.__)("Upload Dataset File (zip or pdf)"),singularLabel:(0,d.__)("dataset")}),(0,a.jsx)(h.CardDivider,{}),(0,a.jsx)(h.ToggleControl,{label:"ATP Dataset",help:"ATP datasets are bound by an opt-in to the ATP Terms of Service.",checked:x,onChange:e=>{r({...o,is_atp:e})}})]})})]})}})})();
//# sourceMappingURL=index.js.map