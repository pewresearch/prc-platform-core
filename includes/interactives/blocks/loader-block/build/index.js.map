{"version":3,"file":"index.js","mappings":"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","sources":["webpack://@pewresearch/prc-platform-interactives-loader/webpack/bootstrap","webpack://@pewresearch/prc-platform-interactives-loader/webpack/runtime/compat get default export","webpack://@pewresearch/prc-platform-interactives-loader/webpack/runtime/define property getters","webpack://@pewresearch/prc-platform-interactives-loader/webpack/runtime/hasOwnProperty shorthand","webpack://@pewresearch/prc-platform-interactives-loader/external window \"React\"","webpack://@pewresearch/prc-platform-interactives-loader/external window [\"wp\",\"primitives\"]","webpack://@pewresearch/prc-platform-interactives-loader/./node_modules/@wordpress/icons/build-module/library/tool.js","webpack://@pewresearch/prc-platform-interactives-loader/external window [\"wp\",\"blocks\"]","webpack://@pewresearch/prc-platform-interactives-loader/external window [\"wp\",\"i18n\"]","webpack://@pewresearch/prc-platform-interactives-loader/external window [\"wp\",\"components\"]","webpack://@pewresearch/prc-platform-interactives-loader/external window [\"wp\",\"element\"]","webpack://@pewresearch/prc-platform-interactives-loader/external window [\"wp\",\"blockEditor\"]","webpack://@pewresearch/prc-platform-interactives-loader/external window [\"wp\",\"apiFetch\"]","webpack://@pewresearch/prc-platform-interactives-loader/external window \"prcComponents\"","webpack://@pewresearch/prc-platform-interactives-loader/./src/data-drop-zone.jsx","webpack://@pewresearch/prc-platform-interactives-loader/./src/edit.jsx","webpack://@pewresearch/prc-platform-interactives-loader/./src/transforms.js","webpack://@pewresearch/prc-platform-interactives-loader/./src/index.js","webpack://@pewresearch/prc-platform-interactives-loader/./src/use-interactives-list.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"React\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"primitives\"];","import { createElement } from \"react\";\n/**\n * WordPress dependencies\n */\nimport { SVG, Path } from '@wordpress/primitives';\nconst tool = createElement(SVG, {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  viewBox: \"0 0 24 24\"\n}, createElement(Path, {\n  d: \"M14.103 7.128l2.26-2.26a4 4 0 00-5.207 4.804L5.828 15a2 2 0 102.828 2.828l5.329-5.328a4 4 0 004.804-5.208l-2.261 2.26-1.912-.512-.513-1.912zm-7.214 9.64a.5.5 0 11.707-.707.5.5 0 01-.707.707z\"\n}));\nexport default tool;\n//# sourceMappingURL=tool.js.map","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"blocks\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"i18n\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"components\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"element\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"blockEditor\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"apiFetch\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"prcComponents\"];","/**\n * External Dependencies\n */\nimport { MediaDropZone } from '@prc/components';\n\n/**\n * WordPress Dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Fragment } from '@wordpress/element';\nimport { Button } from '@wordpress/components';\n\n/**\n * Internal Dependencies\n */\n\nexport default function DataDropZone({id, setNewId, disabled = false, children}) {\n\treturn(\n\t\t<Fragment>\n\t\t\t<MediaDropZone {...{\n\t\t\t\tattachmentId: id,\n\t\t\t\tdisabled,\n\t\t\t\tonUpdate: (attachment) => {\n\t\t\t\t\tif (typeof setNewId === 'function') {\n\t\t\t\t\t\tsetNewId(attachment.id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonClear: () => {\n\t\t\t\t\tif (typeof setNewId === 'function') {\n\t\t\t\t\t\tsetNewId(null);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tmediaType: ['text/csv', 'application/json'], // Machine readable formats only\n\t\t\t\tlabel: __('Drop or Select a Data File (CSV or JSON)'),\n\t\t\t\tsingularLabel: __('Data File'),\n\t\t\t}}>\n\t\t\t\t<Button variant=\"primary\">Modify Data File</Button>\n\t\t\t</MediaDropZone>\n\t\t\t{id && children}\n\t\t</Fragment>\n\t);\n}\n","/* eslint-disable @wordpress/no-unsafe-wp-apis */\n/**\n * External Dependencies\n */\nimport { tool as icon } from '@wordpress/icons';\n\n/**\n * WordPress Dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Placeholder, SelectControl, Button, Flex, FlexBlock, FlexItem } from '@wordpress/components';\nimport { Fragment, useState, useMemo } from '@wordpress/element';\nimport {\n\tuseBlockProps,\n\tWarning,\n} from '@wordpress/block-editor';\n\n/**\n * Internal Dependencies\n */\nimport useInteractivesList from './use-interactives-list';\nimport DataDropZone from './data-drop-zone';\n\nfunction findInteractiveBySlug(obj, slug) {\n\tfor (const key in obj) {\n\t  if (typeof obj[key] === 'object') {\n\t\tconst result = findInteractiveBySlug(obj[key], slug);\n\t\tif (result) {\n\t\t  return result;\n\t\t}\n\t  } else if (obj.hasOwnProperty('slug') && obj.slug === slug) {\n\t\treturn obj;\n\t  }\n\t}\n\treturn null;\n}\n\nexport default function Edit({\n\tattributes,\n\tsetAttributes,\n\tclientId,\n\tcontext,\n}) {\n\tconst {postId} = context;\n\tconst blockProps = useBlockProps();\n\tconst [researchArea, setResearchArea] = useState(null);\n\tconst [year, setYear] = useState(null);\n\tconst [dataViewerOpen, setDataViewerOpen] = useState(false);\n\tconst {slug, dataAttachmentId, legacyWpackIo, legacyAssetsS3} = attributes;\n\n\tconst isLegacy = useMemo(() => {\n\t\treturn legacyWpackIo || legacyAssetsS3;\n\t}, [legacyWpackIo, legacyAssetsS3]);\n\n\tconst { interactives } = useInteractivesList(researchArea, year);\n\n\tconst selectedInteractive = useMemo(() => {\n\t\tif (interactives && slug) {\n\t\t\treturn findInteractiveBySlug(interactives, slug);\n\t\t}\n\t\treturn null;\n\t}, [interactives, slug]);\n\n\tconst placeholderLabel = useMemo(() => {\n\t\treturn selectedInteractive?.title || __('Select Interactive');\n\t}, [selectedInteractive]);\n\n\tconst researchAreaOptions = useMemo(() => {\n\t\tconst defaultValue = { label: 'Select Research Area', value: null };\n\t\tconst options = [\n\t\t\tdefaultValue,\n\t\t];\n\t\tif (interactives) {\n\t\t\tObject.keys(interactives).forEach((researchArea) => {\n\t\t\t\t// const label which is researchArea but with the first letter capitalized\n\t\t\t\tconst label = researchArea.charAt(0).toUpperCase() + researchArea.slice(1);\n\t\t\t\toptions.push({\n\t\t\t\t\tlabel,\n\t\t\t\t\tvalue: researchArea,\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\treturn options;\n\t}, [interactives]);\n\n\tconst yearOptions = useMemo(() => {\n\t\tconst defaultValue = { label: 'Select Year', value: null };\n\t\tconst options = [\n\t\t\tdefaultValue,\n\t\t];\n\t\tif (interactives && researchArea) {\n\t\t\tObject.keys(interactives[researchArea]).forEach((year) => {\n\t\t\t\toptions.push({\n\t\t\t\t\tlabel: year,\n\t\t\t\t\tvalue: year,\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\treturn options;\n\t}, [interactives, researchArea]);\n\n\tconst filteredInteractiveOptions = useMemo(() => {\n\t\tconst defaultValue = { label: 'Select Interactive', value: null };\n\t\t// filter interactives[researchArea][year]\n\t\tif (null === researchArea || null === year) {\n\t\t\treturn [defaultValue];\n\t\t}\n\t\tconst data = interactives?.[researchArea]?.[year];\n\t\tif (!data) {\n\t\t\treturn [defaultValue];\n\t\t}\n\t\tconst options = data.map((interactive) => {\n\t\t\t// get the slug from data by index and store as a const\n\t\t\treturn {\n\t\t\t\tlabel: interactive.title,\n\t\t\t\tvalue: interactive.slug,\n\t\t\t};\n\t\t});\n\t\toptions.unshift(defaultValue);\n\t\treturn options;\n\t}, [interactives, researchArea, year]);\n\n\treturn (\n\t\t<div {...blockProps}>\n\t\t\t{isLegacy && (\n\t\t\t\t<Warning>\n\t\t\t\t\t<p>This interactive is being loaded via legacy means: <strong>{undefined !== legacyWpackIo ? 'WPackIo' : 'Assets S3'}</strong>.</p>\n\t\t\t\t\t<p>Please update this interactive's code and bring it into <i>/interactives</i> and up to <i>@wordpress/scripts</i> build and loading compliance at earliest convenience</p>\n\t\t\t\t\t<Button isDestructive variant=\"primary\" onClick={() => setAttributes({ slug: null, legacyAssetsS3: null, legacyWpackIo: null })} text=\"Reset Interactive Selection\"/>\n\t\t\t\t</Warning>\n\t\t\t)}\n\t\t\t{!isLegacy && (\n\t\t\t\t<Placeholder label={placeholderLabel} icon={icon}>\n\t\t\t\t{null === selectedInteractive && (\n\t\t\t\t\t<Flex gap=\"5px\">\n\t\t\t\t\t\t<FlexItem>\n\t\t\t\t\t\t\t<SelectControl\n\t\t\t\t\t\t\t\tlabel=\"Select Research Area\"\n\t\t\t\t\t\t\t\tvalue={researchArea}\n\t\t\t\t\t\t\t\toptions={researchAreaOptions}\n\t\t\t\t\t\t\t\tonChange={(value) => {\n\t\t\t\t\t\t\t\t\tsetResearchArea(value);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FlexItem>\n\t\t\t\t\t\t<FlexItem>\n\t\t\t\t\t\t\t<SelectControl\n\t\t\t\t\t\t\t\tlabel=\"Select Year\"\n\t\t\t\t\t\t\t\tvalue={year}\n\t\t\t\t\t\t\t\toptions={yearOptions}\n\t\t\t\t\t\t\t\tonChange={(value) => {\n\t\t\t\t\t\t\t\t\tsetYear(value);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FlexItem>\n\t\t\t\t\t\t<FlexBlock>\n\t\t\t\t\t\t\t<SelectControl\n\t\t\t\t\t\t\t\tlabel=\"Select Interactive\"\n\t\t\t\t\t\t\t\tvalue={slug}\n\t\t\t\t\t\t\t\tdisabled={filteredInteractiveOptions.length === 0}\n\t\t\t\t\t\t\t\toptions={filteredInteractiveOptions}\n\t\t\t\t\t\t\t\tonChange={(value) => {\n\t\t\t\t\t\t\t\t\tsetAttributes({ slug: value });\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FlexBlock>\n\t\t\t\t\t</Flex>\n\t\t\t\t)}\n\t\t\t\t{selectedInteractive && (\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Button variant=\"secondary\" onClick={() => setAttributes({ slug: null })} text=\"Reset Interactive Selection\"/>\n\t\t\t\t\t\t<DataDropZone {...{\n\t\t\t\t\t\t\tid: dataAttachmentId,\n\t\t\t\t\t\t\tsetNewId: (id) => {\n\t\t\t\t\t\t\t\tsetAttributes({ dataAttachmentId: id });\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t<p>Data accessible via Rest API:</p>\n\t\t\t\t\t\t\t<p><pre>/wp-json/prc-api/v3/interactives/get-data/{`${dataAttachmentId}`}</pre></p>\n\t\t\t\t\t\t</DataDropZone>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t</Placeholder>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n","/**\n * WordPress Dependencies\n */\nimport { createBlock } from '@wordpress/blocks';\n\nconst BLOCKNAME = 'prc-platform/interactive-loader';\n\nfunction convertLegacyLoader({id, appName, path, deps, version}) {\n\treturn createBlock(BLOCKNAME, {\n\t\tslug: id,\n\t\tlegacyWpackIo: {\n\t\t\tappName,\n\t\t\tpath,\n\t\t\tdeps,\n\t\t}\n\t});\n}\n\nfunction convertAssetsS3Interactive({id, path, react, libraries, styles}) {\n\treturn createBlock(BLOCKNAME, {\n\t\tslug: id,\n\t\tlegacyAssetsS3: {\n\t\t\tpath,\n\t\t\treact,\n\t\t\tlibraries,\n\t\t\tstyles,\n\t\t}\n\t});\n}\n\nfunction converTextRaw(text) {\n\tconsole.log('converTextRaw()', text);\n\tconst isLoadInteractive = null !== text.match(/\\[load_interactive/);\n\tconst isJsInteractive = null !== text.match(/\\[js_interactive/);\n\n\tconst id = text.match(/id=\"([^\"]+)\"/);\n\tconst appName = text.match(/appName=\"([^\"]+)\"/);\n\tconst path = text.match(/path=\"([^\"]+)\"/);\n\tconst deps = text.match(/deps=\"([^\"]+)\"/);\n\tconst version = text.match(/version=\"([^\"]+)\"/);\n\tconst react = text.match(/react=\"([^\"]+)\"/);\n\tconst libraries = text.match(/libraries=\"([^\"]+)\"/);\n\tconst styles = text.match(/styles=\"([^\"]+)\"/);\n\n\tconsole.log('isLoadInteractive', isLoadInteractive);\n\tconsole.log('isJsInteractive', isJsInteractive);\n\tconsole.log(text);\n\n\tif ( isLoadInteractive ) {\n\t\treturn convertLegacyLoader({\n\t\t\tid: null !== id ? id[1] : null,\n\t\t\tappName: null !== appName ? appName[1] : null,\n\t\t\tpath: null !== path ? path[1] : null,\n\t\t\tdeps: null !== deps ? deps[1] : '',\n\t\t\tversion: null !== version ? version[1] : null,\n\t\t});\n\t}\n\n\tif ( isJsInteractive ) {\n\t\treturn convertAssetsS3Interactive({\n\t\t\tid: null !== id ? id[1] : null,\n\t\t\tpath: null !== path ? path[1] : null,\n\t\t\treact: null !== react ? react[1] : null,\n\t\t\tlibraries: null !== libraries ? libraries[1] : null,\n\t\t\tstyles: null !== styles ? styles[1] : null,\n\t\t});\n\t}\n}\n\nconst transforms = {\n\tfrom: [\n\t\t{\n\t\t\ttype: 'shortcode',\n\t\t\ttag: 'load_interactive',\n\t\t\ttransform({\n\t\t\t\tnamed: { id, appName, path, deps, version },\n\t\t\t}) {\n\t\t\t\tconsole.log('name', named);\n\t\t\t\treturn convertLegacyLoader({\n\t\t\t\t\tid,\n\t\t\t\t\tappName,\n\t\t\t\t\tpath,\n\t\t\t\t\tdeps,\n\t\t\t\t\tversion,\n\t\t\t\t});\n\t\t\t},\n\t\t\tisMatch({ named: { id, appName, path } }) {\n\t\t\t\treturn !!id && !!appName && !!path;\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'shortcode',\n\t\t\ttag: 'js_interactive',\n\t\t\ttransform({\n\t\t\t\tnamed: { id, path, libraries, styles, react },\n\t\t\t}) {\n\t\t\t\tconsole.log('name', named);\n\t\t\t\treturn convertAssetsS3Interactive({\n\t\t\t\t\tid,\n\t\t\t\t\tpath,\n\t\t\t\t\treact,\n\t\t\t\t\tlibraries,\n\t\t\t\t\tstyles,\n\t\t\t\t});\n\t\t\t},\n\t\t\tisMatch({ named: { path, react } }) {\n\t\t\t\treturn path, react\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: ['core/shortcode'],\n\t\t\ttransform: ({ text }) => {\n\t\t\t\treturn converTextRaw(text);\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: ['core/html'],\n\t\t\ttransform: ({ content }) => {\n\t\t\t\treturn converTextRaw(content);\n\t\t\t},\n\t\t},\n\t],\n};\n\nexport default transforms;\n","/**\n * Registers a new block provided a unique name and an object defining its behavior.\n *\n * @see https://developer.wordpress.org/block-editor/developers/block-api/#registering-a-block\n */\n\n/**\n * External Dependencies\n */\nimport { tool as icon } from '@wordpress/icons';\n\n/**\n * WordPress Dependencies\n */\nimport { registerBlockType } from '@wordpress/blocks';\n\n/**\n * Internal Dependencies\n */\nimport metadata from './block.json';\nimport edit from './edit';\nimport transforms from './transforms';\n\nconst { name } = metadata;\n\nconst settings = {\n\ticon,\n\tedit,\n\ttransforms,\n};\n\n/**\n * Every block starts by registering a new block type definition.\n *\n * @see https://developer.wordpress.org/block-editor/developers/block-api/#registering-a-block\n */\nregisterBlockType(name, { ...metadata, ...settings });\n","/**\n * WordPress Dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { useEffect, useState, useMemo } from '@wordpress/element';\nimport apiFetch from '@wordpress/api-fetch';\n\nexport default function useInteractivesList(\n\tresearchArea,\n\tyear\n) {\n\tconst [interactives, setInteractives] = useState([]);\n\n\tuseEffect(() => {\n\t\tapiFetch({ path: '/prc-api/v3/interactives/get-assets' }).then((data) => {\n\t\t\tsetInteractives(data);\n\t\t});\n\t}, []);\n\n\treturn {\n\t\tinteractives,\n\t};\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","window","createElement","SVG","xmlns","viewBox","Path","DataDropZone","id","setNewId","disabled","children","Fragment","MediaDropZone","attachmentId","onUpdate","attachment","onClear","mediaType","label","__","singularLabel","Button","variant","findInteractiveBySlug","slug","result","BLOCKNAME","convertLegacyLoader","appName","path","deps","version","createBlock","legacyWpackIo","convertAssetsS3Interactive","react","libraries","styles","legacyAssetsS3","converTextRaw","text","console","log","isLoadInteractive","match","isJsInteractive","from","type","tag","transform","named","isMatch","blocks","content","name","metadata","settings","icon","edit","attributes","setAttributes","clientId","context","postId","blockProps","useBlockProps","researchArea","setResearchArea","useState","year","setYear","dataViewerOpen","setDataViewerOpen","dataAttachmentId","isLegacy","useMemo","interactives","setInteractives","useEffect","apiFetch","then","data","useInteractivesList","selectedInteractive","placeholderLabel","title","researchAreaOptions","options","value","keys","forEach","charAt","toUpperCase","slice","push","yearOptions","filteredInteractiveOptions","defaultValue","map","interactive","unshift","Warning","undefined","isDestructive","onClick","Placeholder","Flex","gap","FlexItem","SelectControl","onChange","FlexBlock","length","transforms","registerBlockType"],"sourceRoot":""}