{"version":3,"file":"index.js","mappings":"yBAAA,IAAI,EAA+BA,OAAc,MCA7C,EAA+BA,OAAW,GAAc,WCW5D,GANe,IAAAC,eAAc,EAAAC,IAAK,CAChCC,MAAO,6BACPC,QAAS,cACR,IAAAH,eAAc,EAAAI,KAAM,CACrBC,EAAG,kMCTD,EAA+BN,OAAW,GAAU,OCApD,EAA+BA,OAAiB,SCAhD,EAA+BA,OAAW,GAAQ,KCAlD,EAA+BA,OAAW,GAAc,WCAxD,EAA+BA,OAAW,GAAW,QCArD,EAA+BA,OAAW,GAAY,SCAtD,EAA+BA,OAAW,GAAe,YCwB9C,SAASO,GAAS,UAChCC,EAAS,WACTC,EAAU,cACVC,IAEA,OACCT,EAAAA,EAAAA,eAACU,EAAAA,kBAAiB,MACjBV,EAAAA,EAAAA,eAACW,EAAAA,UAAS,MACTX,EAAAA,EAAAA,eAACY,EAAAA,SAAQ,MACRZ,EAAAA,EAAAA,eAACa,EAAAA,YAAW,CACXC,OAAOC,EAAAA,EAAAA,IAAG,SAAU,gCACpBC,MAAOR,EACPS,SAAUR,MAMhB,CC1CmCV,OAAW,GAAO,IC6BrD,MAAMmB,EAAY,UACZC,EAAkB,UA4FxB,OAAeC,EAAAA,EAAAA,cA1Ff,UAA2B,WAACC,EAAU,cAAEC,EAAa,SAAEC,EAAQ,YAAEC,EAAW,SAAEC,EAAQ,QAAEC,IACvF,MAAOlB,EAAYC,IAAiBkB,EAAAA,EAAAA,UAAS,IACvCC,GAAsBC,EAAAA,EAAAA,aAAYrB,EAAY,MAE9C,QACLsB,EAAO,MACPC,EAAK,aACLC,EAAY,aACZC,EAAY,gBACZC,GACGR,EAEES,GAAYC,EAAAA,EAAAA,UAAQ,KAAM,CAC/BC,SAAU,EACVX,QAAS,OACTY,QAAS,OACTC,MAAO,OACPC,EAAGZ,KACA,CAACA,KAEC,QAAEa,EAAO,YAAEC,IAAgBC,EAAAA,EAAAA,kBAChC,WACAzB,EACAiB,GAGKS,EAAmBH,IAAU,IAAII,GACjCC,GAAeJ,EACfnC,EAAYmC,IAAgBE,GAE3BG,EAAQC,EAAS/B,IAAYgC,EAAAA,EAAAA,sBACnC,WACA/B,EACA,CAAE2B,GAAID,IAGDM,GAAed,EAAAA,EAAAA,UAAQ,IACrBe,KAAKC,UAAUR,EAAkB1B,IACtC,CAAC0B,IAEES,GAAqBC,EAAAA,EAAAA,+BAAgBJ,GAErCK,GAAaC,EAAAA,EAAAA,iBAEbC,GAAmBC,EAAAA,EAAAA,qBAAoB,CAAC,EAAG,CAChD1C,MAAO+B,EACPC,UACA/B,WACA0C,eAAgBZ,GAAQa,YACrBC,EACAC,EAAAA,YAAYC,sBAGhB,OACC/D,EAAAA,EAAAA,eAACgE,EAAAA,SAAQ,MACThE,EAAAA,EAAAA,eAACM,EAAQ,CACRC,YACAC,aACAC,mBAEDT,EAAAA,EAAAA,eAAA,UAASuD,GACPF,IACArD,EAAAA,EAAAA,eAACiE,EAAAA,QAAO,MACNlD,EAAAA,EAAAA,IAAI,GAAEG,wCAIRX,IACAP,EAAAA,EAAAA,eAACiE,EAAAA,QAAO,MACNlD,EAAAA,EAAAA,IACC,cAAaI,EAAgB+C,wHAKhCpB,IACA9C,EAAAA,EAAAA,eAACiE,EAAAA,QAAO,MACNlD,EAAAA,EAAAA,IAAI,WAAUI,EAAgB+C,2BAGjClE,EAAAA,EAAAA,eAACmE,EAAAA,gCAAiB,CAACC,SAAUlB,IAC1BJ,IAAgBvC,IACjBP,EAAAA,EAAAA,eAAA,UAASyD,MAMd,I,meClGA,MAAQY,KAAIA,GAAKC,EAEXC,EAAW,CAChBC,KAAI,EAIJC,KAAMC,IAQPC,EAAAA,EAAAA,mBAAkBN,EAAM,IAAKC,KAAaC,G","sources":["webpack://search-factoids/external window \"React\"","webpack://search-factoids/external window [\"wp\",\"primitives\"]","webpack://search-factoids/./node_modules/@wordpress/icons/build-module/library/search.js","webpack://search-factoids/external window [\"wp\",\"blocks\"]","webpack://search-factoids/external window \"prcHooks\"","webpack://search-factoids/external window [\"wp\",\"i18n\"]","webpack://search-factoids/external window [\"wp\",\"components\"]","webpack://search-factoids/external window [\"wp\",\"element\"]","webpack://search-factoids/external window [\"wp\",\"coreData\"]","webpack://search-factoids/external window [\"wp\",\"blockEditor\"]","webpack://search-factoids/./src/Controls.jsx","webpack://search-factoids/external window [\"wp\",\"url\"]","webpack://search-factoids/./src/Edit.jsx","webpack://search-factoids/./src/index.js"],"sourcesContent":["var __WEBPACK_NAMESPACE_OBJECT__ = window[\"React\"];","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"primitives\"];","import { createElement } from \"react\";\n/**\n * WordPress dependencies\n */\nimport { SVG, Path } from '@wordpress/primitives';\nconst search = createElement(SVG, {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  viewBox: \"0 0 24 24\"\n}, createElement(Path, {\n  d: \"M13 5c-3.3 0-6 2.7-6 6 0 1.4.5 2.7 1.3 3.7l-3.8 3.8 1.1 1.1 3.8-3.8c1 .8 2.3 1.3 3.7 1.3 3.3 0 6-2.7 6-6S16.3 5 13 5zm0 10.5c-2.5 0-4.5-2-4.5-4.5s2-4.5 4.5-4.5 4.5 2 4.5 4.5-2 4.5-4.5 4.5z\"\n}));\nexport default search;\n//# sourceMappingURL=search.js.map","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"blocks\"];","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"prcHooks\"];","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"i18n\"];","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"components\"];","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"element\"];","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"coreData\"];","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"blockEditor\"];","/* eslint-disable @wordpress/i18n-no-variables */\n/* eslint-disable @wordpress/i18n-no-collapsible-whitespace */\n/* eslint-disable max-lines-per-function */\n/* eslint-disable @wordpress/no-base-control-with-label-without-id */\n/**\n * External Dependencies\n */\n\n/**\n * WordPress Dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { InspectorControls } from '@wordpress/block-editor';\nimport { useState } from '@wordpress/element';\nimport {\n\tPanelBody,\n\tPanelRow,\n\tSelectControl,\n\tBaseControl,\n\tButton,\n\tTextControl,\n} from '@wordpress/components';\nimport { addQueryArgs } from '@wordpress/url';\n\nexport default function Controls({\n\tisMissing,\n\tsearchTerm,\n\tsetSearchTerm\n}) {\n\treturn (\n\t\t<InspectorControls>\n\t\t\t<PanelBody>\n\t\t\t\t<PanelRow>\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\tlabel={__('Search', 'prc-platform-search-factoids')}\n\t\t\t\t\t\tvalue={searchTerm}\n\t\t\t\t\t\tonChange={setSearchTerm}\n\t\t\t\t\t/>\n\t\t\t\t</PanelRow>\n\t\t\t</PanelBody>\n\t\t</InspectorControls>\n\t);\n}\n","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"url\"];","/* eslint-disable @wordpress/i18n-no-variables */\n/* eslint-disable @wordpress/i18n-no-collapsible-whitespace */\n/* eslint-disable @wordpress/no-unsafe-wp-apis */\n/**\n * External Dependencies\n */\nimport { useDebounce } from '@prc/hooks';\n\n/**\n * WordPress Dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { withNotices, TextControl, Placeholder } from '@wordpress/components';\nimport { useMemo, useState, useEffect, Fragment } from '@wordpress/element';\nimport { useEntityBlockEditor, useEntityRecords } from '@wordpress/core-data';\nimport {\n\tuseInnerBlocksProps,\n\t__experimentalRecursionProvider as RecursionProvider,\n\t__experimentalUseHasRecursion as useHasRecursion,\n\tInnerBlocks,\n\tuseBlockProps,\n\tWarning,\n} from '@wordpress/block-editor';\n\n/**\n * Internal Dependencies\n */\nimport Controls from './Controls';\n\nconst POST_TYPE = 'factoid';\nconst POST_TYPE_LABEL = 'Factoid';\n\nfunction SearchFactoidEdit({attributes, setAttributes, noticeUI, setNoticeUI, clientId, context}) {\n\tconst [searchTerm, setSearchTerm] = useState('');\n\tconst debouncedSearchTerm = useDebounce(searchTerm, 500);\n\n\tconst {\n\t\tqueryId,\n\t\tquery,\n\t\tqueryContext,\n\t\ttemplateSlug,\n\t\tpreviewPostType,\n\t} = context;\n\n\tconst queryArgs = useMemo(() => ({\n\t\tper_page: 1,\n\t\tcontext: 'view',\n\t\torderby: 'date',\n\t\torder: 'desc',\n\t\ts: debouncedSearchTerm,\n\t}), [debouncedSearchTerm]);\n\n\tconst { records, hasResolved } = useEntityRecords(\n\t\t'postType',\n\t\tPOST_TYPE,\n\t\tqueryArgs\n\t);\n\n\tconst currentFactoidId = records?.[0]?.id;\n\tconst isResolving = !hasResolved;\n\tconst isMissing = hasResolved && !currentFactoidId;\n\n\tconst [blocks, onInput, onChange] = useEntityBlockEditor(\n\t\t'postType',\n\t\tPOST_TYPE,\n\t\t{ id: currentFactoidId }\n\t);\n\n\tconst recursionKey = useMemo(() => {\n\t\treturn JSON.stringify(currentFactoidId, POST_TYPE);\n\t}, [currentFactoidId]);\n\n\tconst hasAlreadyRendered = useHasRecursion(recursionKey);\n\n\tconst blockProps = useBlockProps();\n\n\tconst innerBlocksProps = useInnerBlocksProps({}, {\n\t\tvalue: blocks,\n\t\tonInput,\n\t\tonChange,\n\t\trenderAppender: blocks?.length\n\t\t\t? undefined\n\t\t\t: InnerBlocks.ButtonBlockAppender,\n\t});\n\n\treturn (\n\t\t<Fragment>\n\t\t<Controls {...{\n\t\t\tisMissing,\n\t\t\tsearchTerm,\n\t\t\tsetSearchTerm\n\t\t}}/>\n\t\t<div {...blockProps}>\n\t\t\t{hasAlreadyRendered && (\n\t\t\t\t<Warning>\n\t\t\t\t\t{__(`${POST_TYPE} cannot be rendered inside itself.`)}\n\t\t\t\t</Warning>\n\t\t\t)}\n\n\t\t\t{isMissing && (\n\t\t\t\t<Warning>\n\t\t\t\t\t{__(\n\t\t\t\t\t\t`A matching ${POST_TYPE_LABEL.toLocaleLowerCase()} could not be found. It may be unavailable at this time, or you have not published any factoids.`\n\t\t\t\t\t)}\n\t\t\t\t</Warning>\n\t\t\t)}\n\n\t\t\t{isResolving && (\n\t\t\t\t<Warning>\n\t\t\t\t\t{__(`Loading ${POST_TYPE_LABEL.toLocaleLowerCase()} â€¦`)}\n\t\t\t\t</Warning>\n\t\t\t)}\n\t\t\t<RecursionProvider uniqueId={recursionKey}>\n\t\t\t\t{!isResolving && !isMissing && (\n\t\t\t\t\t<div {...innerBlocksProps} />\n\t\t\t\t)}\n\t\t\t</RecursionProvider>\n\t\t</div>\n\t\t</Fragment>\n\t);\n}\n\nexport default withNotices(SearchFactoidEdit);\n","/**\n * Registers a new block provided a unique name and an object defining its behavior.\n *\n * @see https://developer.wordpress.org/block-editor/developers/block-api/#registering-a-block\n */\n\n/**\n * External Dependencies\n */\nimport { search as icon } from '@wordpress/icons';\n\n/**\n * WordPress Dependencies\n */\nimport { registerBlockType } from '@wordpress/blocks';\n\n/**\n * Internal Dependencies\n */\nimport Edit from './Edit';\nimport metadata from './block.json';\n\nconst { name } = metadata;\n\nconst settings = {\n\ticon,\n\t/**\n\t * @see ./Edit.jsx\n\t */\n\tedit: Edit,\n};\n\n/**\n * Every block starts by registering a new block type definition.\n *\n * @see https://developer.wordpress.org/block-editor/developers/block-api/#registering-a-block\n */\nregisterBlockType(name, { ...metadata, ...settings });\n"],"names":["window","createElement","SVG","xmlns","viewBox","Path","d","Controls","isMissing","searchTerm","setSearchTerm","InspectorControls","PanelBody","PanelRow","TextControl","label","__","value","onChange","POST_TYPE","POST_TYPE_LABEL","withNotices","attributes","setAttributes","noticeUI","setNoticeUI","clientId","context","useState","debouncedSearchTerm","useDebounce","queryId","query","queryContext","templateSlug","previewPostType","queryArgs","useMemo","per_page","orderby","order","s","records","hasResolved","useEntityRecords","currentFactoidId","id","isResolving","blocks","onInput","useEntityBlockEditor","recursionKey","JSON","stringify","hasAlreadyRendered","useHasRecursion","blockProps","useBlockProps","innerBlocksProps","useInnerBlocksProps","renderAppender","length","undefined","InnerBlocks","ButtonBlockAppender","Fragment","Warning","toLocaleLowerCase","RecursionProvider","uniqueId","name","metadata","settings","icon","edit","Edit","registerBlockType"],"sourceRoot":""}