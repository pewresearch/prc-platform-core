!function(){"use strict";var e,t={113:function(){var e=window.wp.element,t=window.wp.editPost,r=window.wp.hooks,i=window.wp.data;function a(e,t){return console.log("shapeImg",e),e.sizes[t]?{id:e.id,rawUrl:e.url,url:e.sizes[t].url,width:e.sizes[t].width,height:e.sizes[t].height,caption:e.caption,chartArt:!1}:(console.error(`No image size found for ${t}`,e),!1)}const n={A1:!1,A2:!1,A3:!1,A4:!1,XL:!1,facebook:!1,twitter:!1},l=(e,t)=>{const r={};return"A1"===t&&(r.A2=a(e,"A2"),r.XL=a(e,"XL"),r.facebook=a(e,"facebook"),r.twitter=a(e,"twitter")),"A1"!==t&&"A2"!==t||(r.A3=a(e,"A3"),r.A4=a(e,"A4")),"facebook"===t&&(r.twitter=a(e,"twitter")),r[t]=a(e,t),r},o=(e,t)=>{const r=e,i=!e[t].chartArt;return"A2"===t&&(r.A2.chartArt=i,r.A3.chartArt=i,r.A4.chartArt=i),r[t].chartArt=i,r};var s={initStore(e){return{type:"INIT_STORE",items:e}},resetStore(){const{editPost:e}=(0,i.dispatch)("core/editor");return e({featured_media:0}),{type:"RESET_STORE"}},storeImage(e,t){if("A1"===t){const{editPost:r}=(0,i.dispatch)("core/editor");r({featured_media:a(e,t).id})}return{type:"STORE_IMAGE",imgData:e,size:t}},toggleChartArt(e){return{type:"TOGGLE_CHART_ART",size:e}}},c={getArt(e){return e},hasPrimaryImage(e){return!1!==e.A1&&void 0!==e.A1},isChartArt(e,t){return 0!==Object.keys(e).length&&!1!==e[t]&&void 0!==e[t].chartArt&&e[t].chartArt}},d={*getArt(){const{_art:e,artDirection:t}=(0,i.select)("core/editor").getEditedPostAttribute("meta");if(t&&Object.keys(t).length>0&&(yield s.initStore(t)),console.warn("deprecated: _art",e),!(e=>{try{JSON.parse(e)}catch(e){return!1}return!0})(e))return;const r=JSON.parse(e);console.log("art!",r),yield s.initStore(r)}},u=window.wp.i18n,m=window.wp.components,g=window.lodash,p=window.wp.blockEditor,h=window.wp.mediaUtils;const E=["image"],f=t=>{let{size:r,label:a}=t;const n=(0,i.useSelect)((e=>e("prc/art").isChartArt(r))),{toggleChartArt:l}=(0,i.useDispatch)("prc/art");return(0,e.createElement)(m.Flex,{style:{alignItems:"center",borderTop:"1px solid #eaeaea",height:"45px"}},(0,e.createElement)(m.FlexBlock,null,(0,e.createElement)("strong",null,(0,u.__)(a))),(0,e.createElement)(m.FlexItem,null,("A2"===r||"A3"===r||"A4"===r)&&(0,e.createElement)(m.Button,{icon:"chart-pie",label:(0,u.__)("Toggle Chart Art"),isPressed:n,onClick:()=>l(r),text:(0,u.__)("Chart")})))};var _=t=>{let{imageId:r=!1,size:a="A1"}=t;const[n,l]=(0,e.useState)(!1),{media:o}=(0,i.useSelect)((e=>{const{getMedia:t}=e("core");return{media:r?t(r):null}})),s="string"!=typeof(c=a)?"":c.charAt(0).toUpperCase()+c.slice(1);var c;const{storeImage:d}=(0,i.useDispatch)("prc/art"),_=e=>{console.log("interact with data store and update image selection",a,e),d(e,a)},A=e=>{console.log("onDropImage",e),(0,h.uploadMedia)({allowedTypes:E,filesList:e,onFileChange(e){let[t]=e;console.log("onFileChange",t),t.id?(console.log("found!",t),t.sizes=t.media_details.sizes,_(t),l(!1)):(console.log("waiting"),l(!0))},onError(e){console.error(e)}})},w=(0,e.createElement)("p",null,(0,u.__)(`To edit the ${a} image slot for this post you will need permission to upload media.`));let v,b,y;return o&&(console.log("hasMedia!",o,r),(0,g.has)(o,["media_details","sizes",a])&&(v=o.media_details.sizes[a].width,b=o.media_details.sizes[a].height,y=o.media_details.sizes[a].source_url)),(0,e.createElement)("div",{className:"editor-post-featured-image"},(0,e.createElement)(f,{size:a,label:s}),o&&(0,e.createElement)("div",{id:`editor-post-featured-image-${r}-describedby`,className:"hidden"},o.alt_text&&(0,u.sprintf)(
// Translators: %s: The selected image alt text.
(0,u.__)("Current image: %s"),o.alt_text),!o.alt_text&&(0,u.sprintf)(
// Translators: %s: The selected image filename.
(0,u.__)("The current image has no alternative text. The file name is: %s"),o.media_details.sizes?.full?.file||o.slug)),(0,e.createElement)(p.MediaUploadCheck,{fallback:w},(0,e.createElement)(p.MediaUpload,{title:(0,u.__)(`${s} Image Slot`),onSelect:_,allowedTypes:E,value:r,render:t=>{let{open:i}=t;return(0,e.createElement)("div",{className:"editor-post-featured-image__container"},(0,e.createElement)(m.Button,{className:r?"editor-post-featured-image__preview":"editor-post-featured-image__toggle",onClick:i,"aria-label":r?(0,u.__)("Edit or update the image"):null,"aria-describedby":r?`editor-post-featured-image-${r}-describedby`:null},!!r&&o&&!1===n&&(0,e.createElement)(m.ResponsiveWrapper,{naturalWidth:v,naturalHeight:b,isInline:!0},(0,e.createElement)("img",{src:y,alt:""})),(!!r&&!o||n)&&(0,e.createElement)(m.ResponsiveWrapper,{naturalWidth:240,naturalHeight:139,isInline:!0},(0,e.createElement)("div",{style:{backgroundColor:"#f0f0f0"}},(0,e.createElement)(m.Spinner,null))),!r&&(0,u.__)(`Set ${s} Image`)),(0,e.createElement)(m.DropZone,{onFilesDrop:A}))}})))};const A=()=>{const[t,r]=(0,e.useState)(null),[a,n]=(0,e.useState)(!1),{resetStore:l}=(0,i.useDispatch)("prc/art");return(0,e.useEffect)((()=>{!0===t&&(n(!0),setTimeout((()=>{n(!1),l(),r(null)}),1300))}),[t]),(0,e.createElement)(m.Button,{isDestructive:!0,isBusy:a,onClick:()=>{null===t?r(!1):!1===t&&r(!0)}},null===t?(0,u.__)("Reset All"):!1===t?(0,u.__)("Confirm Reset"):(0,u.__)("Resettingâ€¦"))},w=t=>{let{items:r,size:i}=t;return(0,e.createElement)(_,{imageId:!("object"!=typeof r[i]||!r[i].hasOwnProperty("id"))&&r[i].id,size:i})},v=()=>{const{items:t,hasPrimaryImage:r}=(0,i.useSelect)((e=>({items:e("prc/art").getArt(),hasPrimaryImage:e("prc/art").hasPrimaryImage()})),[]),{editPost:a}=(0,i.useDispatch)("core/editor");return(0,e.useEffect)((()=>{(e=>{if(!1!==e.A1){const t=e;console.log("storing art direction",t),a({meta:{artDirection:t}})}})(t)}),[t]),(0,e.createElement)(e.Fragment,null,(0,e.createElement)("p",null,(0,e.createElement)("i",null,r?"The A1 image slot will set all image slots to the same\n                        image. A2 will set A3 and 4 to the same image. Facebook\n                        will set Twitter to the same image.":"To get started drag an image file into,or click, the image slot.")),(0,e.createElement)(w,{items:t,size:"A1"}),r&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(w,{items:t,size:"A2"}),(0,e.createElement)(m.Flex,null,(0,e.createElement)(m.FlexBlock,null,(0,e.createElement)(w,{items:t,size:"A3"})),(0,e.createElement)(m.FlexBlock,null,(0,e.createElement)(w,{items:t,size:"A4"}))),(0,e.createElement)(w,{items:t,size:"XL"}),(0,e.createElement)(m.Flex,null,(0,e.createElement)(m.FlexBlock,null,(0,e.createElement)(w,{items:t,size:"facebook"})),(0,e.createElement)(m.FlexBlock,null,(0,e.createElement)(w,{items:t,size:"twitter"})))))};var b=()=>(console.log("HELLO ART WORLD"),(0,e.createElement)("div",{id:"prc-block-editor-art-direction"},(0,e.createElement)(v,null),(0,e.createElement)(A,null)));(0,i.registerStore)("prc/art",{reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,t=arguments.length>1?arguments[1]:void 0;switch(console.log("reducer",e,t),t.type){case"INIT_STORE":return{...t.items};case"RESET_STORE":return{...n};case"STORE_IMAGE":return{...e,...{...l(t.imgData,t.size)}};case"TOGGLE_CHART_ART":return{...e,...{...o(e,t.size)}}}return e},actions:s,selectors:c,controls:{},resolvers:d}),(0,r.addFilter)("editor.PostFeaturedImage","prc-block-plugins/art-direction",(()=>()=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)(b,null),(0,e.createElement)(t.PluginPrePublishPanel,{title:"Review Featured Image",initialOpen:!0},(0,e.createElement)(b,null)))))}},r={};function i(e){var a=r[e];if(void 0!==a)return a.exports;var n=r[e]={exports:{}};return t[e](n,n.exports,i),n.exports}i.m=t,e=[],i.O=function(t,r,a,n){if(!r){var l=1/0;for(d=0;d<e.length;d++){r=e[d][0],a=e[d][1],n=e[d][2];for(var o=!0,s=0;s<r.length;s++)(!1&n||l>=n)&&Object.keys(i.O).every((function(e){return i.O[e](r[s])}))?r.splice(s--,1):(o=!1,n<l&&(l=n));if(o){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[r,a,n]},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={826:0,431:0};i.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,n,l=r[0],o=r[1],s=r[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(a in o)i.o(o,a)&&(i.m[a]=o[a]);if(s)var d=s(i)}for(t&&t(r);c<l.length;c++)n=l[c],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(d)},r=self.webpackChunk_pewresearch_art_direction=self.webpackChunk_pewresearch_art_direction||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var a=i.O(void 0,[431],(function(){return i(113)}));a=i.O(a)}();