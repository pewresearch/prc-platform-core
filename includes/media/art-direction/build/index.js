(()=>{"use strict";var e,t={790:()=>{const e=window.wp.hooks,t=window.wp.element,r=window.prcComponents,o=window.wp.i18n,i=window.wp.primitives,n=window.ReactJSXRuntime,l=(0,n.jsx)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,n.jsx)(i.Path,{d:"M19 3H5c-.6 0-1 .4-1 1v7c0 .5.4 1 1 1h14c.5 0 1-.4 1-1V4c0-.6-.4-1-1-1zM5.5 10.5v-.4l1.8-1.3 1.3.8c.3.2.7.2.9-.1L11 8.1l2.4 2.4H5.5zm13 0h-2.9l-4-4c-.3-.3-.8-.3-1.1 0L8.9 8l-1.2-.8c-.3-.2-.6-.2-.9 0l-1.3 1V4.5h13v6zM4 20h9v-1.5H4V20zm0-4h16v-1.5H4V16z"})}),s=window.prcHooks,a=window.wp.coreData,c=window.wp.data,d=(0,t.createContext)();function p(e,t){return e.sizes[t]?{id:e.id,rawUrl:e.url,url:e.sizes[t].url,width:e.sizes[t].width,height:e.sizes[t].height,caption:e.caption,chartArt:!1}:(console.error(`No image size found for ${t}`,e),!1)}const g=()=>{const{postId:e,postType:r,testMeta:o}=(0,c.useSelect)((e=>({postId:e("core/editor").getCurrentPostId(),postType:e("core/editor").getCurrentPostType(),testMeta:e("core/editor").getCurrentPostAttribute("meta")})),[]),[i,n]=(0,a.useEntityProp)("postType",r,"meta",e),{canDelete:l,isResolving:d}=(0,a.useResourcePermissions)(r,e),g=(0,t.useMemo)((()=>(console.log("ART CHECK Permissions Check:",d,l),!d)),[d,l]),[m,h]=(0,t.useState)(i.artDirection||{}),u=(0,s.useDebounce)(m,500);(0,t.useEffect)((()=>{console.log("ART DIRECTION:",i,o,u,m,g),g&&void 0!==i?(u.A1&&!1!==u.A1&&(function(e=!1){if(!1!==e){const{editPost:t}=(0,c.dispatch)("core/editor");t({featured_media:e.id})}}(u.A1),console.log("Featured Image: ",u.A1)),JSON.stringify(u)!==JSON.stringify(i.artDirection)?(console.log("Art Direction Change Detected",u,i),console.log("ART DIRECTION UPDATE: ",u,i),n({...i,artDirection:u})):console.log("No Art Direction Change Detected",u,i.artDirection)):console.log("ART DIRECTION UHOH: Can't edit or no meta",g,i)}),[u,g,i,n]);const x=(0,t.useMemo)((()=>!!m.A1),[m]),A=(0,t.useMemo)((()=>{const e=Object.keys(u),t=u[e[0]];console.log("allSlotsTheSame",e,t);for(let r=1;r<e.length;r++){console.log("allSlotsTheSame...",t,u[e[r]]);let o=0;if(t.id!==u[e[r]].id&&(o+=1),t.chartArt!==u[e[r]].chartArt&&(o+=1),o>0)return console.log("allSlotsTheSame...","not all the same"),!1}return console.log("allSlotsTheSame...","all the same"),!0}),[u]);return{allowEditing:g,postId:e,postType:r,artDirection:u,hasA1Image:x,setImageSlot:(e,t)=>{const r=function(e,t){const r={};return"A1"===t&&(r.A2=p(e,"A2"),r.XL=p(e,"XL"),r.facebook=p(e,"facebook"),r.twitter=p(e,"twitter")),"A1"!==t&&"A2"!==t||(r.A3=p(e,"A3"),r.A4=p(e,"A4")),"facebook"===t&&(r.twitter=p(e,"twitter")),r[t]=p(e,t),r}(e,t);h({...m,...r})},getImageSlot:e=>m?.[e],isImageSlotBordered:e=>m?.[e]?.chartArt,toggleImageSlotBordered:e=>{let t={...m};t=function(e={},t){const r=!e[t].chartArt;return"A2"===t?(e.A2.chartArt=r,e.A3.chartArt=r,e.A4.chartArt=r):e[t].chartArt=r,console.log("prc-platform/art-direction propagateBorderedToggle::",e),e}(t,e),h({...t})},capitalize:e=>"string"!=typeof e?"":e.charAt(0).toUpperCase()+e.slice(1),allSlotsTheSame:A}},m=()=>(0,t.useContext)(d);function h({children:e}){const t=g();return(0,n.jsx)(d.Provider,{value:t,children:e})}const u=window.wp.components;function x({label:e,size:r}){const{isImageSlotBordered:o,toggleImageSlotBordered:i,capitalize:l}=m(),s=o(r),a=(0,t.useMemo)((()=>e||l(r)),[e,r,l]);return(0,n.jsxs)(u.Flex,{style:{alignItems:"center",borderTop:"1px solid #eaeaea",height:"45px"},children:[(0,n.jsx)(u.FlexBlock,{children:(0,n.jsx)("strong",{children:a})}),(0,n.jsx)(u.FlexItem,{children:("A2"===r||"A3"===r||"A4"===r)&&(0,n.jsx)(u.ToggleControl,{__nextHasNoMarginBottom:!0,label:"Border",onChange:()=>i(r),checked:s})})]})}function A({size:e,labels:o,onClick:i,overlayActive:l,enableLabel:s=!0}){const{getImageSlot:a,setImageSlot:c,capitalize:d}=m(),p=(0,t.useMemo)((()=>a(e)),[e,a]),g=(0,t.useMemo)((()=>p?p.id:null),[p]),h=d(e);return(0,n.jsxs)("div",{className:"prc-platform-art-direction__slot",children:[s&&(0,n.jsx)(x,{label:o?.label||`${h}`,size:e}),(0,n.jsx)(r.MediaImageSlot,{id:g,size:e,labels:o||{label:`Edit ${h} Image Slot`,title:`Select ${h} Image`,update:`Update ${h} Image Slot`,dropzone:`Drop ${h}`},onUpdate:t=>{c(t,e)},onClick:i,overlayActive:l})]})}function f(){const{hasA1Image:e}=m();return(0,n.jsxs)("div",{className:"prc-platform-art-direction__list",children:[(0,n.jsx)("p",{children:(0,n.jsx)(u.ExternalLink,{href:"https://platform.pewresearch.org/wiki/art-direction",children:"Art Direction Documentation"})}),(0,n.jsx)("p",{style:{background:"var(--wp--custom--color-grey-spectrum-light-one)",padding:"0.5em 1em",marginLeft:"-1em",marginRight:"-1em",marginTop:"1em",marginBottom:"-1px"},children:(0,n.jsx)("strong",{children:"Story Item"})}),(0,n.jsx)(A,{size:"A1"}),e&&(0,n.jsxs)(t.Fragment,{children:[(0,n.jsx)(A,{size:"A2"}),(0,n.jsxs)(u.Flex,{children:[(0,n.jsx)(u.FlexBlock,{children:(0,n.jsx)(A,{size:"A3"})}),(0,n.jsx)(u.FlexBlock,{children:(0,n.jsx)(A,{size:"A4"})})]}),(0,n.jsx)("p",{style:{background:"var(--wp--custom--color-grey-spectrum-light-one)",padding:"0.5em 1em",marginLeft:"-1em",marginRight:"-1em",marginTop:"1em",marginBottom:"-1px"},children:(0,n.jsx)("strong",{children:"Social"})}),(0,n.jsxs)(u.Flex,{children:[(0,n.jsx)(u.FlexBlock,{children:(0,n.jsx)(A,{size:"facebook"})}),(0,n.jsx)(u.FlexBlock,{children:(0,n.jsx)(A,{size:"twitter"})})]})]})]})}function w(){const{hasA1Image:e,allSlotsTheSame:t}=m();return(0,n.jsx)(r.InspectorPopoutPanel,{title:(0,o.__)("Art Direction"),className:"prc-platform-art-direction-panel",renderToggle:({isOpen:r,onToggle:o})=>(0,n.jsx)(A,{size:"A1",labels:{label:"Setup Art Direction",title:"Select Art Direction Image",update:t?"Update Art Direction":"Update Art Direction (Some Slots Differ)",dropzone:"Drop A1 Image",icon:l},onClick:e?o:void 0,enableLabel:!1,overlayActive:r}),children:(0,n.jsx)(f,{})})}function j(){return(0,n.jsx)(h,{children:(0,n.jsx)(w,{})})}const v=window.wp.editPost;function S(){return(0,n.jsx)(v.PluginPrePublishPanel,{title:"Review Art Direction",initialOpen:!0,children:(0,n.jsx)(h,{children:(0,n.jsx)(f,{})})})}(0,e.addFilter)("editor.PostFeaturedImage","prc-platform/art-direction",(function(){return()=>(0,n.jsxs)(t.Fragment,{children:[(0,n.jsx)(j,{}),(0,n.jsx)(S,{})]})})),(0,e.addFilter)("prc-platform.attachments-panel","prc-platform/art-direction",(function(e){return()=>(0,n.jsxs)(t.Fragment,{children:[(0,n.jsx)(e,{}),(0,n.jsx)(h,{children:(0,n.jsx)(u.PanelBody,{title:"Art Direction",initialOpen:!1,children:(0,n.jsx)(f,{})})})]})}))}},r={};function o(e){var i=r[e];if(void 0!==i)return i.exports;var n=r[e]={exports:{}};return t[e](n,n.exports,o),n.exports}o.m=t,e=[],o.O=(t,r,i,n)=>{if(!r){var l=1/0;for(d=0;d<e.length;d++){r=e[d][0],i=e[d][1],n=e[d][2];for(var s=!0,a=0;a<r.length;a++)(!1&n||l>=n)&&Object.keys(o.O).every((e=>o.O[e](r[a])))?r.splice(a--,1):(s=!1,n<l&&(l=n));if(s){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[r,i,n]},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};o.O.j=t=>0===e[t];var t=(t,r)=>{var i,n,l=r[0],s=r[1],a=r[2],c=0;if(l.some((t=>0!==e[t]))){for(i in s)o.o(s,i)&&(o.m[i]=s[i]);if(a)var d=a(o)}for(t&&t(r);c<l.length;c++)n=l[c],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(d)},r=self.webpackChunk_pewresearch_art_direction=self.webpackChunk_pewresearch_art_direction||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var i=o.O(void 0,[350],(()=>o(790)));i=o.O(i)})();
//# sourceMappingURL=index.js.map